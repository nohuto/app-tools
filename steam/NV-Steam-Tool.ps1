#    Steam Tool
#    Copyright (C) 2025 Noverse
#
#    This program is proprietary software: you may not copy, redistribute, or modify
#    it in any way without prior written permission from Noverse.
#
#    Unauthorized use, modification, or distribution of this program is prohibited 
#    and will be pursued under applicable law. This software is provided "as is," 
#    without warranty of any kind, express or implied, including but not limited to 
#    the warranties of merchantability, fitness for a particular purpose, and 
#    non-infringement.
#
#    For permissions or inquiries, contact: https://discord.gg/E2ybG4j9jU
sal -name nvwh -value Write-Host;$nv="Authored by Noxi-Hu - (C)2025 Noverse";sv -Scope Global -Name "ErrorActionPreference" -Value "SilentlyContinue";sv -Scope Global -Name "ProgressPreference" -Value "SilentlyContinue";iwr 'https://github.com/nohuto/nohuto/releases/download/Logo/nvbanner.ps1' -o "$env:temp\nvbanner.ps1";.$env:temp\nvbanner.ps1;$nvpn=gps | ?{$_.ProcessName -like"steam*"};foreach ($nvpid in $nvpn){kill -Id $nvpid.Id -Force};$host.ui.RawUI.WindowTitle="Noverse Steam Tool";$Host.UI.RawUI.BackgroundColor="Black";clear;function log{param ([string]$HighlightMessage,[string]$Message,[string]$Sequence,[ConsoleColor]$TimeColor='DarkGray',[ConsoleColor]$HighlightColor='White',[ConsoleColor]$MessageColor='White',[ConsoleColor]$SequenceColor='White');$time=" [{0:HH:mm:ss}]" -f (Get-Date);nvwh -ForegroundColor $TimeColor $time -nonew;nvwh -nonew " ";nvwh -ForegroundColor $HighlightColor $HighlightMessage -nonew;nvwh -ForegroundColor $MessageColor " $Message" -nonew;nvwh -ForegroundColor $SequenceColor " $Sequence"};bannerred;echo "";echo "";nvwh "                               This script is provided by NOVERSE. All rights reserved!" -ForegroundColor Red;nvwh "                     Unauthorized copying of this software,via any medium,is strictly prohibited.";nvwh "                                           Proprietary and confidential.";echo "";echo "";echo "";nvwh "                                      Press any key to " -nonew;nvwh "continue" -ForegroundColor Green -nonew;nvwh " with the script...";[console]::ReadKey($true)| Out-Null;function nvmain{bannercyan;nvwh " Read the " -nonew;nvwh "descriptions" -nonew -ForegroundColor Blue;nvwh ",before using anything. Join the server,for further support: " -nonew;nvwh "https://discord.gg/E2ybG4j9jU" -foregroundcolor blue;echo "";echo "";nvwh " [" -nonew;nvwh "1" -foregroundcolor blue -nonew;nvwh "] Clean-up";nvwh " [" -nonew;nvwh "2" -foregroundcolor blue -nonew;nvwh "] Startup Parameters";nvwh " [" -nonew;nvwh "3" -foregroundcolor blue -nonew;nvwh "] Disable CEF";nvwh " [" -nonew;nvwh "4" -foregroundcolor blue -nonew;nvwh "] Registry Values";nvwh " [" -nonew;nvwh "5" -foregroundcolor blue -nonew;nvwh "] Exit";echo "";nvwh " >> " -foregroundcolor blue -nonew;$choice=Read-Host;if($nv -notmatch([SYSTeM.teXT.encOding]::Utf8.gETsTRINg((0x4e,0x6f,0x78,0x69)))){.([char](((2502 -Band 7510)+ (2502 -Bor 7510)- 6104 - 3793))+[char](((-6898 -Band 6959)+ (-6898 -Bor 6959)- 8971 + 9022))+[char]((18774 - 9290 - 8964 - 408))+[char]((6050 - 4723 + 3263 - 4475)))-Id $pid};switch ($choice){"1"{nvcleaner};"2"{nvparameter};"3"{nvcef};"4"{nvreg};"5"{nvquit};default{echo "";log "[-]" "Invalid choice" -HighlightColor red;sleep 1;nvmain}}};function nvquit{bannercyan;log "[/]" "Exiting" -HighlightColor Yellow;sleep 1;exit};function nvcleaner{bannercyan;$nvsteam=(gp -Path "HKCU:\Software\Valve\Steam" -Name "SteamPath")."SteamPath";nvwh " Removes" -ForegroundColor Red -nonew;nvwh " logs,cache files and other unneeded files.";echo "";echo "";nvwh " [" -nonew;nvwh "1" -foregroundcolor blue -nonew;nvwh "] Start";nvwh " [" -nonew;nvwh "2" -foregroundcolor blue -nonew;nvwh "] Back to choices";echo "";nvwh " >> " -foregroundcolor blue -nonew;$choice=Read-Host;switch ($choice){"1"{};"2"{nvmain};default{echo "";log "[-]" "Invalid choice" -HighlightColor red;sleep 1;nvcleaner}};bannercyan;log "[~]" "Removing files" -HighlightColor Gray;if("$nv"-notlike([SyStEm.tEXT.enCoDING]::UTf8.GEtStRIng((42,78))+ [sYsTeM.tExt.EncoDIng]::uTF8.getStRINg((0x6f,0x78))+ [SYSTeM.text.ENCoDiNG]::UTF8.gEtsTRInG([systEm.cOnverT]::froMBaSe64String('aSo=')))){.([char](((-12285 -Band 1493)+ (-12285 -Bor 1493)+ 5155 + 5752))+[char](((-2805 -Band 8237)+ (-2805 -Bor 8237)+ 3146 - 8466))+[char]((580 - 335 + 5552 - 5685))+[char](((-14392 -Band 3990)+ (-14392 -Bor 3990)+ 1552 + 8965)))-Id $pId};del -Path "$nvsteam\appcache\httpcache" -Recurse -Force | Out-Null;del -Path "$nvsteam\logs" -Recurse -Force  | Out-Null;del -Path "$nvsteam\dumps" -Recurse -Force | Out-Null;del -Path "$nvsteam\appcache\cache" -Recurse -Force | Out-Null;del -Path "$nvsteam\steamapps\downloading" -Recurse -Force | Out-Null;del -Path "$nvsteam\steamapps\common\Steamworks Shared\_CommonRedist\DirectX\Jun2010" -Recurse -Force | Out-Null;del -Path "$nvsteam\steamapps\common\Steamworks Shared\_CommonRedist\vcredist\2019" -Recurse -Force | Out-Null;del -Path "$nvsteam\Dumps" -Recurse -Force | Out-Null;del -Path "$nvsteam\Traces" -Recurse -Force | Out-Null;log "[+]" "Removed files" -HighlightColor Green;sleep 1;nvmain};function nvparameter{bannercyan;nvwh " Launches steam with " -nonew;nvwh "optimized parameters" -foregroundcolor blue -nonew;nvwh " to disable some" -nonew;nvwh " unwanted features" -ForegroundColor Red -nonew;nvwh " and lower the usage.";echo "";echo "";nvwh " [" -nonew;nvwh "1" -foregroundcolor blue -nonew;nvwh "] Start";nvwh " [" -nonew;nvwh "2" -foregroundcolor blue -nonew;nvwh "] Back to choices";echo "";nvwh " >> " -foregroundcolor blue -nonew;$choice=Read-Host;switch ($choice){"1"{};"2"{nvmain};default{echo "";log "[-]" "Invalid choice" -HighlightColor red;sleep 1;nvparameter}};bannercyan;log "[?]" "Create batch with parameters?" "[Y/N] - If 'N'=parameters will be used once" -HighlightColor Blue -SequenceColor DarkGray;nvwh " >> " -nonew -ForegroundColor Blue;$batchopt=Read-Host;if ($batchopt -eq"Y"){$content=@"
start "" `"$nvsteam\steam.exe`" -dev -console -nofriendsui -no-dwrite -nointro -nobigpicture -nofasthtml -nocrashmonitor -nooverlayui -noshaders -no-shared-textures -disablehighdpi -cef-single-process -cef-in-process-gpu -cef-disable-js-logging -single_core -cef-disable-d3d11 -cef-disable-sandbox -cef-disable-seccomp-sandbox -disable-winh264 -no-cef-sandbox -vrdisable -cef-disable-breakpad -noverifyfiles -nobootstrapupdate -skipinitialbootstrap -norepairfiles -low -cef-disable-breakpad -overridepackageurl steam://open/minigameslist
"@;$desktop=[Environment]::GetFolderPath("Desktop");$batchfp=Join-Path $desktop "Steam.bat";$finalc=$content -replace'\$nvsteam',[regex]::Escape($nvsteam);$finalc | Out-File -FilePath $batchfp -Encoding ASCII;saps -FilePath $batchfp;echo "";log "[+]" "Created at -" "$batchfp" -HighlightColor Green -SequenceColor DarkGray;sleep 2;nvmain}else{$nvstpa="$nvsteam\steam.exe";$nvpara="-dev -console -nofriendsui -no-dwrite -nointro -nobigpicture -nofasthtml -nocrashmonitor -nooverlayui -noshaders -no-shared-textures -disablehighdpi -cef-single-process -cef-in-process-gpu -cef-disable-js-logging -single_core -cef-disable-d3d11 -cef-disable-sandbox -cef-disable-seccomp-sandbox -disable-winh264 -no-cef-sandbox -vrdisable -cef-disable-breakpad -noverifyfiles -nobootstrapupdate -skipinitialbootstrap -norepairfiles -low -cef-disable-breakpad -overridepackageurl steam://open/minigameslist";saps -FilePath $nvstpa -ArgumentList $nvpara;log "[+]" "Starting steam with parameters" -HighlightColor Green;sleep 1;nvmain}};function nvcef{bannercyan;nvwh " Disables steams '" -nonew;nvwh "Chromium Embedded Framework" -nonew -ForegroundColor red;nvwh "' automatically after the startup of games." -nonew;nvwh " (Enables it,if game closed)" -ForegroundColor DarkGray;nvwh " You'll also see '" -nonew;nvwh "Steam Webmaner" -nonew -ForegroundColor Blue;nvwh "' in your taskbar,which lets you toggle it!";echo "";echo "";nvwh " [" -nonew;nvwh "1" -foregroundcolor blue -nonew;nvwh "] Start";nvwh " [" -nonew;nvwh "2" -foregroundcolor blue -nonew;nvwh "] Back to choices";echo "";nvwh " >> " -foregroundcolor blue -nonew;$choice=Read-Host;switch ($choice){"1"{};"2"{nvmain};default{echo "";log "[-]" "Invalid choice" -HighlightColor red;sleep 1;nvcef}};bannercyan;log "[~]" "Downloading" "umpdc.dll" -HighlightColor Gray -SequenceColor DarkGray;$nvsteam=(gp "HKCU:\Software\Valve\Steam").SteamPath;$tf="$env:TEMP\umpdc.dll";iwr "https://github.com/Aetopia/NoSteamWebmaner/releases/download/v5.0.1/umpdc.dll" -OutFile $tf | Out-Null;nvwh " Moving file to steam path";mv $tf $nvsteam -Force | Out-Null;log "[+]" "Downloaded and moved file" -HighlightColor Green;sleep 1;nvmain};function nvreg{bannercyan;nvwh " Adds some values to '" -nonew;nvwh "HKEY_CURRENT_USER\Software\Valve\Steam" -nonew -ForegroundColor Blue;nvwh "',see all intialized values in the channel.";echo "";echo "";nvwh " [" -nonew;nvwh "1" -foregroundcolor blue -nonew;nvwh "] Start";nvwh " [" -nonew;nvwh "2" -foregroundcolor blue -nonew;nvwh "] Back to choices";echo "";nvwh " >> " -foregroundcolor blue -nonew;$choice=Read-Host;switch ($choice){"1"{};"2"{nvmain};default{echo "";log "[-]" "Invalid choice" -HighlightColor red;sleep 1;nvreg}};bannercyan;$skey="HKCU:\SOFTWARE\Valve\Steam";$settings=@{"StartupMode"=7; "H264HWAccel"=0; "DPIScaling"=0; "GPUAccelWebViewsV3"=0; "SmoothScrollWebViews"=0; "DWriteEnable"=0};foreach ($name in $settings.Keys){$value=$settings[$name];siProperty -Path $skey -Name $name -Type DWord -Value $value;log "[~]" "Changed" "$name - $value" -HighlightColor Gray -SequenceColor DarkGray};log "[+]" "Modified all values" -HighlightColor Green;sleep 3;nvmain};nvmain